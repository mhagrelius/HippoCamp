---
name: Core Data Models and Entities
status: closed
created: 2025-09-05T00:41:49Z
updated: 2025-09-05T02:07:02Z
github: https://github.com/mhagrelius/HippoCamp/issues/14
depends_on: [001]
parallel: false
conflicts_with: []
---

# Task 002: Core Data Models and Entities

## Description
Implement the core Memory entity with embedding support, metadata storage, and related data transfer objects. Create the DbContext with proper entity configurations and relationships to support the memory storage requirements outlined in the PRD.

## Acceptance Criteria
- [ ] Memory entity implemented with all required properties
- [ ] MemoryType enum created with all specified types
- [ ] DbContext configured with proper entity relationships
- [ ] DTOs created for API request/response operations
- [ ] Entity validation and constraints implemented
- [ ] Embedding storage properly configured for vector operations
- [ ] Metadata JSON serialization working correctly
- [ ] Database schema matches PRD specifications
- [ ] All entities properly indexed for performance

## Technical Details

### Core Entities
```csharp
public class Memory
{
    public Guid Id { get; set; }
    public string ProjectId { get; set; }
    public string Content { get; set; }
    public float[] Embedding { get; set; }
    public MemoryType Type { get; set; }
    public DateTime Created { get; set; }
    public DateTime LastAccessed { get; set; }
    public Dictionary<string, object> Metadata { get; set; }
    public bool IsDeprecated { get; set; }
}

public enum MemoryType
{
    ArchitecturalDecision,
    CodePattern,
    BugPattern,
    PerformanceOptimization,
    UserPreference
}
```

### DbContext Configuration
- Configure Memory entity with proper column types
- Set up embedding column for vector operations
- Configure JSON serialization for metadata
- Implement proper indexing strategy
- Set up foreign key relationships and constraints

### DTOs and Models
- CreateMemoryDto for memory creation requests
- MemoryResponseDto for API responses
- SearchMemoryDto for search operations
- UpdateMemoryDto for memory updates
- Validation attributes on all DTOs

### Data Validation
- Content length validation
- Embedding dimension consistency
- ProjectId format validation
- Metadata structure validation
- Required field validation

## Dependencies
- Task 001: Database Setup and Configuration
- Entity Framework Core with PostgreSQL provider
- JSON serialization libraries
- FluentValidation for model validation

## Effort Estimate
**Size**: Medium (M)  
**Hours**: 12-16 hours  
**Complexity**: Moderate - involves entity modeling and EF Core configuration

## Definition of Done
- All entities are properly defined with correct data types
- DbContext is configured and generates correct database schema
- Migrations create the expected database structure
- DTOs provide proper abstraction for API operations
- All validation rules are implemented and tested
- Embedding storage supports vector operations
- Metadata serialization works correctly with complex objects
- Code follows HippoCamp naming and structure conventions
- Entity relationships and constraints are properly configured
